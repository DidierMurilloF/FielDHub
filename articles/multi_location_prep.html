<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="FielDHub">
<title>Optimized Multi-Location P-rep Design • FielDHub</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Optimized Multi-Location P-rep Design">
<meta property="og:description" content="FielDHub">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">FielDHub</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">1.3.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/sparse_allocation.html">Sparse Allocation/Testing</a>
    <a class="dropdown-item" href="../articles/diagonal_arrangement.html">Unreplicated Diagonal Arrangement Design</a>
    <a class="dropdown-item" href="../articles/optimized_arrangement.html">Unreplicated Optimized Arrangement Design</a>
    <a class="dropdown-item" href="../articles/RCBD_augmented.html">Augmented Randomized Complete Block Design</a>
    <a class="dropdown-item" href="../articles/partially_replicated.html">Partially Replicated Design</a>
    <a class="dropdown-item" href="../articles/multi_location_prep.html">Optimized Multi-Location P-rep</a>
    <a class="dropdown-item" href="../articles/square_lattice.html">Square Lattice Design</a>
    <a class="dropdown-item" href="../articles/rectangular_lattice.html">Rectangular Lattice Design</a>
    <a class="dropdown-item" href="../articles/alpha_lattice.html">Alpha Lattice Design</a>
    <a class="dropdown-item" href="../articles/crd.html">Completely Randomized Design</a>
    <a class="dropdown-item" href="../articles/rcbd.html">Randomized Complete Block Design</a>
    <a class="dropdown-item" href="../articles/latin_square.html">Latin Square Design</a>
    <a class="dropdown-item" href="../articles/full_factorial.html">Full Factorial Design</a>
    <a class="dropdown-item" href="../articles/split_plot.html">Split-Plot Design</a>
    <a class="dropdown-item" href="../articles/split_split_plot.html">Split-Split Plot Design</a>
    <a class="dropdown-item" href="../articles/strip_plot.html">Strip-Plot Design</a>
    <a class="dropdown-item" href="../articles/incomplete_blocks.html">Incomplete Block Design</a>
    <a class="dropdown-item" href="../articles/row_column.html">Row-Column Design</a>
    <a class="dropdown-item" href="../articles/methods.html">Methods in FielDHub</a>
  </div>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-news">News</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-news">
    <h6 class="dropdown-header" data-toc-skip>Releases</h6>
    <a class="dropdown-item" href="../articles/news/fieldhub-1-2-0.html">Version 1.2.0</a>
    <a class="dropdown-item" href="../articles/news/fieldhub-0-1-0.html">Version 0.1.0</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../news/index.html">Changelog</a>
  </div>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/DidierMurilloF/FielDHub/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">



<script src="multi_location_prep_files/kePrint-0.0.1/kePrint.js"></script><link href="multi_location_prep_files/lightable-0.0.1/lightable.css" rel="stylesheet">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Optimized Multi-Location P-rep Design</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/DidierMurilloF/FielDHub/blob/HEAD/vignettes/multi_location_prep.Rmd" class="external-link"><code>vignettes/multi_location_prep.Rmd</code></a></small>
      <div class="d-none name"><code>multi_location_prep.Rmd</code></div>
    </div>

    
    
<p>This vignette shows how to generate an <strong>optimized
multi-location partially replicated design</strong> using both the
FielDHub Shiny App and the scripting function
<code><a href="../reference/multi_location_prep.html">multi_location_prep()</a></code> from the <code>FielDHub</code> R
package.</p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>Partially replicated designs are frequently used in initial
generation field trials. This design type involves replicating a portion
of the entries, while the remaining entries only appear once in the
experiment. The optimized partially replicated (p-rep) design utilizes a
genotype allocation matrix to determine the distribution of replicated
and non-replicated entries across multiple locations, employing the
principles of incomplete block designs (IBD).</p>
</div>
<div class="section level2">
<h2 id="use-case">Use case<a class="anchor" aria-label="anchor" href="#use-case"></a>
</h2>
<p>Suppose there is a plant breeding field trial with 150 entries to be
tested across five environments, where up to seven replications of each
entry are allowed. Additionally, the project includes three checks; each
replicated six times. We can generate an optimized multi-location
partially replicated design using these parameters. This strategy
guarantees that all treatments are present in all environments but in
different amounts of replications. We can generate this design using the
FielDHub Shiny app and the FielDHub <code><a href="../reference/multi_location_prep.html">multi_location_prep()</a></code>
standalone function in R.</p>
</div>
<div class="section level2">
<h2 id="running-the-shiny-app">Running the Shiny App<a class="anchor" aria-label="anchor" href="#running-the-shiny-app"></a>
</h2>
<p>To launch the app you need to run either</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">FielDHub</span><span class="fu">::</span><span class="fu"><a href="../reference/run_app.html">run_app</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>or</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DidierMurilloF/FielDHub" class="external-link">FielDHub</a></span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/run_app.html">run_app</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-the-fieldhub-shiny-app">1. Using the FielDHub Shiny App<a class="anchor" aria-label="anchor" href="#using-the-fieldhub-shiny-app"></a>
</h2>
<p>Once the app is running, click the tab <strong>Partially Replicated
Design</strong> and select <strong>Optimized Multi-Location
p-rep</strong> from the dropdown.</p>
<p>Then, follow the following steps where we will show how to generate
an optimized partially replicated design.</p>
</div>
<div class="section level2">
<h2 id="inputs">Inputs<a class="anchor" aria-label="anchor" href="#inputs"></a>
</h2>
<ol style="list-style-type: decimal">
<li>
<p><strong>Import entries’ list?</strong> Choose whether to import a
list with entry numbers and names for genotypes or treatments.</p>
<ul>
<li><p>If the selection is <code>No</code>, that means the app is going
to generate synthetic data for entries and names of the
treatment/genotypes based on the user inputs.</p></li>
<li><p>If the selection is <code>Yes</code>, the entries list must
fulfill a specific format and must be a <code>.csv</code> file. The file
must have the columns <code>ENTRY</code> and <code>NAME</code>. The
<code>ENTRY</code> column must have a unique entry integer number for
each treatment/genotype. The column <code>NAME</code> must have a unique
name that identifies each treatment/genotype. Both <code>ENTRY</code>
and <code>NAME</code> must be unique, duplicates are not allowed. In the
following table, we show an example of the entries list format.</p></li>
</ul>
</li>
</ol>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:right;">
ENTRY
</th>
<th style="text-align:left;">
NAME
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:right;">
1
</td>
<td style="text-align:left;">
Genotype1
</td>
</tr>
<tr>
<td style="text-align:right;">
2
</td>
<td style="text-align:left;">
Genotype2
</td>
</tr>
<tr>
<td style="text-align:right;">
3
</td>
<td style="text-align:left;">
Genotype3
</td>
</tr>
<tr>
<td style="text-align:right;">
4
</td>
<td style="text-align:left;">
Genotype4
</td>
</tr>
<tr>
<td style="text-align:right;">
5
</td>
<td style="text-align:left;">
Genotype5
</td>
</tr>
<tr>
<td style="text-align:right;">
6
</td>
<td style="text-align:left;">
Genotype6
</td>
</tr>
<tr>
<td style="text-align:right;">
7
</td>
<td style="text-align:left;">
Genotype7
</td>
</tr>
<tr>
<td style="text-align:right;">
8
</td>
<td style="text-align:left;">
Genotype8
</td>
</tr>
<tr>
<td style="text-align:right;">
9
</td>
<td style="text-align:left;">
Genotype9
</td>
</tr>
<tr>
<td style="text-align:right;">
10
</td>
<td style="text-align:left;">
Genotype10
</td>
</tr>
</tbody>
</table>
<ol start="2" style="list-style-type: decimal">
<li><p>Enter the number of entries in the <strong>Input # of
Entries</strong> box as a comma separated list. In our example we will
have 150 entries, so we enter 150 in the box for our sample
experiment.</p></li>
<li><p>Select whether or not the experiment will contain checks under
the <strong>Include checks?</strong> option. The example experiment
does, so set this to <code>Yes</code>.</p></li>
<li><p>Once we select <code>Yes</code> on the above option, two more
boxes appear, the first being <strong>Input # of Checks</strong> where
we set how many checks to include in the experiment. In our case this is
3.</p></li>
<li><p>Next to this option we have <strong>Input # Check’s
Reps</strong>, where we set the number of replications for each check
respectively in a comma separated list. We are replicating each of the 3
checks 6 times, so enter <code>6,6,6</code> in this box.</p></li>
<li><p>Enter the number of locations in <strong>Input # of
Locations</strong>. We will run this experiment over 5 locations, so set
<strong>Input # of Locations</strong> to 5.</p></li>
<li><p>Set the total number of replications of the entries over all
locations in the <code># of Copies Per Entry</code> dropdown box. For
this example experiment, set this to 7.</p></li>
<li><p>Select <code>serpentine</code> or <code>cartesian</code> in the
<strong>Plot Order Layout</strong>. For this example we will use the
default <code>serpentine</code> layout.</p></li>
<li><p>To ensure that randomizations are consistent across sessions, we
can set a random seed in the box labeled <strong>Random Seed</strong>.
In this example, we will set it to <code>2456</code>.</p></li>
<li><p>(Optional) Enter the starting plot number in the <strong>Starting
Plot Number</strong> box. Since the experiment has multiple locations,
you must enter a comma separated list of numbers the length of the
number of locations for the input to be valid. In this example, we will
set it as <code>1,1001,2001,3001,4001</code>.</p></li>
<li><p>(Optional) Enter the location names in the <strong>Input Location
Name</strong> box. Since the experiment has six locations, you must
enter a comma separated list of strings for the names of the
environments. In this example, we will set it as
<code>LOC1,LOC2,LOC3,LOC4,LOC5</code>.</p></li>
</ol>
<p>Once we have entered the information for our experiment on the left
side panel, click the <strong>Run!</strong> button to run the design.
You will then be prompted to select the dimensions of the field from the
list of options in the dropdown in the middle of the screen with the box
labeled <strong>Select dimensions of field</strong>. In our case, we
will select <code>12 x 19</code>. Click the <strong>Randomize!</strong>
button to randomize the experiment with the set field dimensions and to
see the output plots. If you change the dimensions again, you must
re-randomize.</p>
<p>If you change any of the inputs on the left side panel after running
an experiment initially, you have to click the Run and Randomize buttons
again, to re-run with the new inputs.</p>
</div>
<div class="section level2">
<h2 id="outputs">Outputs<a class="anchor" aria-label="anchor" href="#outputs"></a>
</h2>
<p>After you run a <code>Optimized Multi-Location P-rep Design</code> in
FielDHub and set the dimensions of the field, there are several ways to
display the information contained in the field book. The first tab,
<strong>Get Random</strong>, shows the option to change the dimensions
of the field and re-randomize, as well as the genotype allocation matrix
generated for the optimized p-rep design, which displays the
replications of each genotype over each location, much like the matrix
generated in sparse allocation.</p>
<div class="section level3">
<h3 id="randomized-field">Randomized Field<a class="anchor" aria-label="anchor" href="#randomized-field"></a>
</h3>
<p>The <strong>Randomized Field</strong> tab displays a graphical
representation of the randomization of the entries in a field of the
specified dimensions. The replicated entries are the green colored
cells, with the which cells appearing only once in the location. The
display includes numbered labels for the rows and columns. You can copy
the field as a table or save it directly as an Excel file with the
<em>Copy</em> and <em>Excel</em> buttons at the top.</p>
</div>
<div class="section level3">
<h3 id="plot-number-field">Plot Number Field<a class="anchor" aria-label="anchor" href="#plot-number-field"></a>
</h3>
<p>On the <strong>Plot Number Field</strong> tab, there is a table
display of the field with the plots numbered according to the Plot Order
Layout specified, either <em>serpentine</em> or <em>cartesian</em>. You
can see the corresponding entries for each plot number in the field
book. Like the Randomized Field tab, you can copy the table or save it
as an Excel file with the <em>Copy</em> and <em>Excel</em> buttons.</p>
</div>
<div class="section level3">
<h3 id="field-book">Field Book<a class="anchor" aria-label="anchor" href="#field-book"></a>
</h3>
<p>The <strong>Field Book</strong> displays all the information on the
experimental design in a table format. It contains the specific plot
number and the row and column address of each entry, as well as the
corresponding treatment/genotype on that plot. This table is searchable,
and we can filter the data in relevant columns.</p>
</div>
</div>
<div class="section level2">
<h2 id="using-the-fieldhub-function-multi_location_prep-">2. Using the <code>FielDHub</code> function:
<code>multi_location_prep()</code>.<a class="anchor" aria-label="anchor" href="#using-the-fieldhub-function-multi_location_prep-"></a>
</h2>
<p>You can run the same design with the function
<code><a href="../reference/multi_location_prep.html">multi_location_prep()</a></code> in the <code>FielDHub</code>
package.</p>
<p>First, you need to load the <code>FielDHub</code> package typing,</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/DidierMurilloF/FielDHub" class="external-link">FielDHub</a></span><span class="op">)</span></span></code></pre></div>
<p>Then, you can enter the information describing the above design like
this:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">optim_multi_prep</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/multi_location_prep.html">multi_location_prep</a></span><span class="op">(</span></span>
<span>  lines <span class="op">=</span> <span class="fl">150</span>, </span>
<span>  l <span class="op">=</span> <span class="fl">5</span>, </span>
<span>  copies_per_entry <span class="op">=</span> <span class="fl">7</span>, </span>
<span>  checks <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  rep_checks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">6</span>,<span class="fl">6</span>,<span class="fl">6</span><span class="op">)</span>,</span>
<span>  plotNumber <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1001</span>,<span class="fl">2001</span>,<span class="fl">3001</span>,<span class="fl">4001</span><span class="op">)</span>,</span>
<span>  locationNames <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"LOC1"</span>, <span class="st">"LOC2"</span>, <span class="st">"LOC3"</span>, <span class="st">"LOC4"</span>, <span class="st">"LOC5"</span><span class="op">)</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">2456</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="section level4">
<h4 id="details-on-the-inputs-entered-in-optimized_arrangement-above">Details on the inputs entered in
<code>optimized_arrangement()</code> above<a class="anchor" aria-label="anchor" href="#details-on-the-inputs-entered-in-optimized_arrangement-above"></a>
</h4>
<p>The description for the inputs that we used to generate the
design,</p>
<ul>
<li>
<code>lines = 150</code> is the number of entries in the field.</li>
<li>
<code>l = 5</code> is the number of locations.</li>
<li>
<code>copies_per_entry = 7</code> is the number of copies of each
entry.</li>
<li>
<code>checks = 3</code> is the (optional) number of checks.</li>
<li>
<code>rep_checks = c(6,6,6)</code> is the (optional) number of
replications of each check, in a vector the length of the number of
checks.</li>
<li>
<code>locationNames = c("LOC1", "LOC2", "LOC3", "LOC4", "LOC5")</code>
are optional names for the locations.</li>
<li>
<code>seed = 2456</code> is the random seed to replicate identical
randomizations.</li>
</ul>
</div>
<div class="section level3">
<h3 id="print-optim_multi_prep-object">Print <code>optim_multi_prep</code> object<a class="anchor" aria-label="anchor" href="#print-optim_multi_prep-object"></a>
</h3>
<p>To print a summary of the information that is in the object
<code>optim_multi_prep</code>, we can use the generic function
<code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code>.</p>
<p>The <code><a href="../reference/sparse_allocation.html">sparse_allocation()</a></code> function returns a list of 4
objects, <code>designs</code>, <code>list_locs</code>,
<code>allocation</code>, and <code>size_locations</code>. The object
<code>designs</code> contains the randomization and information about
the design parameters for each location, while <code>list_locs</code> is
a list of data frames. Each data frame has two columns;
<code>ENTRY</code> and <code>NAME</code> with the information to
randomize to each environment. The object <code>allocation</code> is the
binary allocation matrix of genotypes to locations, and
<code>size_locations</code> is a data frame with a column for each
location and a row indicating the size of the location (number of field
plots).</p>
<p>For example, we can display the <code>allocation</code> object. Let
us print the first ten genotypes allocation.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">optim_multi_prep</span><span class="op">$</span><span class="va">allocation</span>, <span class="fl">10</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code>   LOC1 LOC2 LOC3 LOC4 LOC5
1     2    1    2    1    1
2     1    2    1    1    2
3     1    1    1    2    2
4     1    1    2    1    2
5     1    2    1    2    1
6     2    1    1    2    1
7     2    1    2    1    1
8     1    2    2    1    1
9     1    2    1    1    2
10    2    2    1    1    1</code></pre>
<p>Let us add two new columns to the allocation table. We can add the
number of copies by genotype; it should be 7 for all of them. We can
also add the average allocation by genotype. Each treatment will appear
1.4 times in average.</p>
<table class="table table" style="margin-left: auto; margin-right: auto;">
<thead><tr>
<th style="text-align:left;">
</th>
<th style="text-align:right;">
LOC1
</th>
<th style="text-align:right;">
LOC2
</th>
<th style="text-align:right;">
LOC3
</th>
<th style="text-align:right;">
LOC4
</th>
<th style="text-align:right;">
LOC5
</th>
<th style="text-align:right;">
Copies
</th>
<th style="text-align:right;">
Avg
</th>
</tr></thead>
<tbody>
<tr>
<td style="text-align:left;">
Gen-1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen-2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen-3
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen-4
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen-5
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen-6
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen-7
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen-8
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen-9
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
<tr>
<td style="text-align:left;">
Gen-10
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
2
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
1
</td>
<td style="text-align:right;">
7
</td>
<td style="text-align:right;">
1.4
</td>
</tr>
</tbody>
</table>
<p>We can manipulate the sparse_allocation object as any other list in
R. For example, we can save the design randomizations to an object
called <code>designs</code>, and then index based on location using the
dollar sign operator. We can first display the design parameters for
<code>LOC1</code> with the following code:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design_randomization</span> <span class="op">&lt;-</span> <span class="va">optim_multi_prep</span><span class="op">$</span><span class="va">designs</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">design_randomization</span><span class="op">$</span><span class="va">LOC1</span><span class="op">)</span></span></code></pre></div>
<p>which outputs:</p>
<pre><code>Partially Replicated Design 

Information on the design parameters: 
List of 8
 $ min_distance           : num 4
 $ rows                   : num 19
 $ columns                : num 12
 $ treatments_with_reps   : int 63
 $ treatments_with_no_reps: int 90
 $ locations              : num 1
 $ planter                : chr "serpentine"
 $ seed                   : num 2456

 10 First observations of the data frame with the partially_replicated field book: 
   ID     EXPT LOCATION YEAR PLOT ROW COLUMN CHECKS ENTRY TREATMENT
1   1 PrepExpt     LOC1 2023    1   1      1     43    43      G-43
2   2 PrepExpt     LOC1 2023    2   1      2     46    46      G-46
3   3 PrepExpt     LOC1 2023    3   1      3      0   102     G-102
4   4 PrepExpt     LOC1 2023    4   1      4      0   114     G-114
5   5 PrepExpt     LOC1 2023    5   1      5      6   151    CH-151
6   6 PrepExpt     LOC1 2023    6   1      6      0   142     G-142
7   7 PrepExpt     LOC1 2023    7   1      7     76   152    CH-152
8   8 PrepExpt     LOC1 2023    8   1      8     58    58      G-58
9   9 PrepExpt     LOC1 2023    9   1      9      0   118     G-118
10 10 PrepExpt     LOC1 2023   10   1     10     77    77      G-77</code></pre>
<p>And for environment 2 by changing the location to print to
<code>LOC2</code>:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">design_randomization</span><span class="op">$</span><span class="va">LOC2</span><span class="op">)</span></span></code></pre></div>
<p>which outputs:</p>
<pre><code>Partially Replicated Design 

Information on the design parameters: 
List of 8
 $ min_distance           : num 4
 $ rows                   : num 19
 $ columns                : num 12
 $ treatments_with_reps   : int 63
 $ treatments_with_no_reps: int 90
 $ locations              : num 1
 $ planter                : chr "serpentine"
 $ seed                   : num 2456

 10 First observations of the data frame with the partially_replicated field book: 
   ID     EXPT LOCATION YEAR PLOT ROW COLUMN CHECKS ENTRY TREATMENT
1   1 PrepExpt     LOC2 2023 1001   1      1     37    37      G-37
2   2 PrepExpt     LOC2 2023 1002   1      2     39    39      G-39
3   3 PrepExpt     LOC2 2023 1003   1      3      0    99      G-99
4   4 PrepExpt     LOC2 2023 1004   1      4      0   120     G-120
5   5 PrepExpt     LOC2 2023 1005   1      5      5   151    CH-151
6   6 PrepExpt     LOC2 2023 1006   1      6      0   136     G-136
7   7 PrepExpt     LOC2 2023 1007   1      7     78   152    CH-152
8   8 PrepExpt     LOC2 2023 1008   1      8     60    60      G-60
9   9 PrepExpt     LOC2 2023 1009   1      9      0   123     G-123
10 10 PrepExpt     LOC2 2023 1010   1     10     80    80      G-80</code></pre>
</div>
<div class="section level3">
<h3 id="access-to-optim_multi_prep-output">Access to <code>optim_multi_prep</code> output<a class="anchor" aria-label="anchor" href="#access-to-optim_multi_prep-output"></a>
</h3>
<p>The object <code>designs</code> we saved
<code>optim_multi_prep$designs</code> to is a list consisting of all the
information displayed in the output tabs in the FielDHub app: design
information, plot layout, plot numbering, entries list, and field book,
indexed by each location in the experiment. These are accessible by the
<code>$</code> operator, i.e. <code>designs$LOC1$layoutRandom</code> or
<code>designs$LOC1$fieldBook</code> for <code>LOC1</code>, etc.</p>
<p><code>designs$LOC1$fieldBook</code> is a data frame containing
information about every plot in the field, with information about the
location of the plot and the treatment in each plot. As seen in the
output below, the field book has columns for <code>ID</code>,
<code>EXPT</code>, <code>LOCATION</code>, <code>YEAR</code>,
<code>PLOT</code>, <code>ROW</code>, <code>COLUMN</code>,
<code>CHECKS</code>, <code>ENTRY</code>, and <code>TREATMENT</code>.</p>
<p>Let us see the first 10 rows of the field book for the first location
in this experiment.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">field_book</span> <span class="op">&lt;-</span> <span class="va">design_randomization</span><span class="op">$</span><span class="va">LOC1</span><span class="op">$</span><span class="va">fieldBook</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">field_book</span>, <span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<pre><code>   ID     EXPT LOCATION YEAR PLOT ROW COLUMN CHECKS ENTRY TREATMENT
1   1 PrepExpt     LOC1 2023    1   1      1     43    43      G-43
2   2 PrepExpt     LOC1 2023    2   1      2     46    46      G-46
3   3 PrepExpt     LOC1 2023    3   1      3      0   102     G-102
4   4 PrepExpt     LOC1 2023    4   1      4      0   114     G-114
5   5 PrepExpt     LOC1 2023    5   1      5      6   151    CH-151
6   6 PrepExpt     LOC1 2023    6   1      6      0   142     G-142
7   7 PrepExpt     LOC1 2023    7   1      7     76   152    CH-152
8   8 PrepExpt     LOC1 2023    8   1      8     58    58      G-58
9   9 PrepExpt     LOC1 2023    9   1      9      0   118     G-118
10 10 PrepExpt     LOC1 2023   10   1     10     77    77      G-77</code></pre>
</div>
<div class="section level3">
<h3 id="plot-field-layout">Plot field layout<a class="anchor" aria-label="anchor" href="#plot-field-layout"></a>
</h3>
<p>For plotting the layout in function of the coordinates
<code>ROW</code> and <code>COLUMN</code> in the field book object we can
use the generic function <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> as follows. This plots only
the first location, but this is indexable by location using the dollar
sign operator as well.</p>
<div class="section level4">
<h4 id="field-layout-for-location-1">Field Layout for Location 1<a class="anchor" aria-label="anchor" href="#field-layout-for-location-1"></a>
</h4>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">design_randomization</span><span class="op">$</span><span class="va">LOC1</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi_location_prep_files/figure-html/unnamed-chunk-18-1.png" width="691.2" style="display: block; margin: auto;"></p>
<p>In the figure above, green plots contain replicated entries, and gray
plots contain entries that only appear once.</p>
</div>
<div class="section level4">
<h4 id="field-layout-for-location-5">Field Layout for Location 5<a class="anchor" aria-label="anchor" href="#field-layout-for-location-5"></a>
</h4>
<p>Also, for example the location five:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">design_randomization</span><span class="op">$</span><span class="va">LOC5</span><span class="op">)</span></span></code></pre></div>
<p><img src="multi_location_prep_files/figure-html/unnamed-chunk-19-1.png" width="691.2" style="display: block; margin: auto;"></p>
<p><br><br><br></p>
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Didier Murillo, Salvador Gezan.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
